var CustomStyle=function(){function t(){}var e=["ms","Moz","Webkit","O"],n={};return t.getProp=function(t,i){if(1==arguments.length&&"string"==typeof n[t])return n[t];i=i||document.documentElement;var r,s,o=i.style;if("string"==typeof o[t])return n[t]=t;s=t.charAt(0).toUpperCase()+t.slice(1);for(var a=0,l=e.length;l>a;a++)if(r=e[a]+s,"string"==typeof o[r])return n[t]=r;return n[t]="undefined"},t.setProp=function(t,e,n){var i=this.getProp(t);"undefined"!=i&&(e.style[i]=n)},t}(),TextLayerBuilder=function(t){var e=document.createDocumentFragment();this.textLayerDiv=t.textLayerDiv,this.layoutDone=!1,this.divContentDone=!1,this.pageIdx=t.pageIndex,this.matches=[],this.lastScrollSource=t.lastScrollSource,"undefined"==typeof PDFFindController&&(window.PDFFindController=null),"undefined"==typeof this.lastScrollSource&&(this.lastScrollSource=null),this.beginLayout=function(){this.textDivs=[],this.renderingDone=!1},this.endLayout=function(){this.layoutDone=!0,this.insertDivContent()},this.renderLayer=function(){var t=this.textDivs,n=this.textContent.bidiTexts,i=this.textLayerDiv,r=document.createElement("canvas"),s=r.getContext("2d"),o=1e5;if(!(t.length>o)){for(var a=0,l=t.length;l>a;a++){var d=t[a];if(!("isWhitespace"in d.dataset)){e.appendChild(d),s.font=d.style.fontSize+" "+d.style.fontFamily;var h=s.measureText(d.textContent).width;if(h>0){var c=d.dataset.canvasWidth/h,u=d.dataset.angle,f="scale("+c+", 1)";"ttb"===n[a].dir&&(u+=90),f="rotate("+u+"deg) "+f,CustomStyle.setProp("transform",d,f),CustomStyle.setProp("transformOrigin",d,"0% 0%"),i.appendChild(d)}}}this.renderingDone=!0,this.updateMatches(),i.appendChild(e)}},this.setupRenderLayoutTimer=function(){var t=200,e=this,n=null===this.lastScrollSource?0:this.lastScrollSource.lastScroll;Date.now()-n>t?this.renderLayer():(this.renderTimer&&clearTimeout(this.renderTimer),this.renderTimer=setTimeout(function(){e.setupRenderLayoutTimer()},t))},this.appendText=function(t){var e=document.createElement("div"),n=t.fontSize*Math.abs(t.vScale);e.dataset.canvasWidth=t.canvasWidth*Math.abs(t.hScale),e.dataset.fontName=t.fontName,e.dataset.angle=t.angle*(180/Math.PI),e.style.fontSize=n+"px",e.style.fontFamily=t.fontFamily,e.style.left=t.x+n*Math.sin(t.angle)+"px",e.style.top=t.y-n*Math.cos(t.angle)+"px",this.textDivs.push(e)},this.insertDivContent=function(){if(this.layoutDone&&!this.divContentDone&&this.textContent){this.divContentDone=!0;for(var t=this.textDivs,e=this.textContent.bidiTexts,n=0;n<e.length;n++){var i=e[n],r=t[n];/\S/.test(i.str)?(r.textContent=i.str,r.dir="rtl"===i.dir?"rtl":"ltr"):r.dataset.isWhitespace=!0}this.setupRenderLayoutTimer()}},this.setTextContent=function(t){this.textContent=t,this.insertDivContent()},this.convertMatches=function(t){for(var e=0,n=0,i=this.textContent.bidiTexts,r=i.length-1,s=null===PDFFindController?0:PDFFindController.state.query.length,o=[],a=0;a<t.length;a++){for(var l=t[a];e!==r&&l>=n+i[e].str.length;)n+=i[e].str.length,e++;e==i.length&&console.error("Could not find matching mapping");var d={begin:{divIdx:e,offset:l-n}};for(l+=s;e!==r&&l>n+i[e].str.length;)n+=i[e].str.length,e++;d.end={divIdx:e,offset:l-n},o.push(d)}return o},this.renderMatches=function(t){function e(t,e){var n=t.divIdx,i=o[n];i.textContent="";var r=s[n].str.substring(0,t.offset),a=document.createTextNode(r);if(e){var h=l&&n===d,c=document.createElement("span");return c.className=e+(h?" selected":""),c.appendChild(a),void i.appendChild(c)}i.appendChild(a)}function n(t,e,n){var i=t.divIdx,r=o[i],a=s[i].str.substring(t.offset,e.offset),l=document.createTextNode(a);if(n){var d=document.createElement("span");return d.className=n,d.appendChild(l),void r.appendChild(d)}r.appendChild(l)}function i(t,e){o[t].className=e}if(0!==t.length){var r,s=this.textContent.bidiTexts,o=this.textDivs,a=null,l=null===PDFFindController?!1:this.pageIdx===PDFFindController.selected.pageIdx,d=null===PDFFindController?-1:PDFFindController.selected.matchIdx,h=null===PDFFindController?!1:PDFFindController.state.highlightAll,c={divIdx:-1,offset:void 0},u=d,f=u+1;if(h)u=0,f=t.length;else if(!l)return;for(r=u;f>r;r++){var v=t[r],g=v.begin,x=v.end,p=l&&r===d,m=p?" selected":"";if(p&&scrollIntoView(o[g.divIdx],{top:-50}),a&&g.divIdx===a.divIdx?n(a,g):(null!==a&&n(a,c),e(g)),g.divIdx===x.divIdx)n(g,x,"highlight"+m);else{n(g,c,"highlight begin"+m);for(var C=g.divIdx+1;C<x.divIdx;C++)i(C,"highlight middle"+m);e(x,"highlight end"+m)}a=x}a&&n(a,c)}},this.updateMatches=function(){if(this.renderingDone){for(var t=this.matches,e=this.textDivs,n=this.textContent.bidiTexts,i=-1,r=0;r<t.length;r++){for(var s=t[r],o=Math.max(i,s.begin.divIdx),a=o;a<=s.end.divIdx;a++){var l=e[a];l.textContent=n[a].str,l.className=""}i=s.end.divIdx+1}null!==PDFFindController&&PDFFindController.active&&(this.matches=t=this.convertMatches(null===PDFFindController?[]:PDFFindController.pageMatches[this.pageIdx]||[]),this.renderMatches(this.matches))}}};